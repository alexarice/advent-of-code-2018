module Day02 where

import Data.List

codes=["umdryebvlapkozostecnihjexg","amdryebalapkozfstwcnrhjqxg","umdcyebvlapaozfstwcnihjqgg","ymdryrbvlapkozfstwcuihjqxg","umdrsebvlapkozxstwcnihjqig","umdryibvlapkohfstwcnfhjqxg","umdryebvqapkozfatwcnihjqxs","umzrpebvlapkozfshwcnihjqxg","fmhryebvlapkozfstwckihjqxg","umdryebvlahkozfstwcnizjrxg","qmdryebvlapkozfslwcnihgqxg","umdiyebjlapknzfstwcnihjqxg","umdryebvlapkoqfstwcaihvqxg","cmdryebvlapkpzfstwcnihjvxg","umdryebvlakkozfstwcgihjixg","umdryebvlasjozfstwcnihqqxg","umdryebvladkozfsvwcnifjqxg","umdrlebvlapaozfstwcniwjqxg","umdryebvlhpkozrstwsnihjqxg","umdryebvcapkozfqtwcnihjrxg","ubdrykbvlapkowfstwcnihjqxg","umdryebvldpkozfstwcnihtqsg","umdryebvlapaozyutwcnihjqxg","umdryibvlapkozfstdfnihjqxg","umdryebvlapgozkstwznihjqxg","umdrxebvlapkozfstwcngxjqxg","umdryekvlapkozfstwclchjqxg","nmdryebvlapkozjsewcnihjqxg","umdryebvyapkozfstfcniheqxg","umdfyebvlapkozfstwcnhhjpxg","umdryelylupkozfstwcnihjqxg","smdryebvlqpkozfstwcnihjdxg","umdryebvlapaozfsuwcnihjqxc","umdryebvlrzkozrstwcnihjqxg","umdbycbvlapkojfstwcnihjqxg","umdryebvlapkonfstwpnirjqxg","uecryebvlapkozfstwcnihpqxg","uqdryebvltpkozfstwcnihrqxg","umdryebvlqsknzfstwcnihjqxg","cmdryebvlapkocfstwcvihjqxg","umdrkebvlapkozqsfwcnihjqxg","umdryabveapkoifstwcnihjqxg","ummrnehvlapkozfstwcnihjqxg","umdryebvlxpkozfstwqnihjtxg","umdryebvlagkozastwcnihjqxh","umdryebvlatkozzhtwcnihjqxg","umdryebvlcpkozfstwrnihjqvg","umdryebvlapkozfsnwcnrhjcxg","umdzyebvlypkozfstwcnibjqxg","nmdryebvlvpkozbstwcnihjqxg","uwdryebvlipkozfstwcnihvqxg","umdraebvlavkozfstwcnihjqwg","umdeyebvlspbozfstwcnihjqxg","umdryxlvlapkozfstwcnihjqxu","umdryegvlapkqzfstwcnirjqxg","umdrupbvlapkozfstwcnihjqog","imxryebvlapkxzfstwcnihjqxg","umdrfebvlapkozowtwcnihjqxg","umdreebvlapkozmstwczihjqxg","undryebdlapkozbstwcnihjqxg","umdryebvlapkpzfetwcnihjqxb","ymdnyebvlapkozfstwinihjqxg","umdryebvaapkozfstwcnihyqqg","umdryebvlapkzzwsrwcnihjqxg","umdrkebvlapkmzfskwcnihjqxg","umdrmebvlapkozfsvwcnidjqxg","umdlyehvlapkozfstwcnihjqkg","umnryebvlrpkozfstwjnihjqxg","uqdryebvlapxozfsawcnihjqxg","vmdruebvlapkozfstwcnihjqqg","umdryabviapkozistwcnihjqxg","umdryebvlapkzzfstwfnihkqxg","uvdryebvlapkozfsxwcuihjqxg","umdlhebvlapkozfstwcnvhjqxg","umdreebvlapkopfstjcnihjqxg","umdryebvlazkomfstwynihjqxg","kmdryebulapkoznstwcnihjqxg","umdryebvxakkozfstwinihjqxg","ukdryobvlapkozistwcnihjqxg","umdryebveapkozfstwcnthjqgg","mmdrtebvlapcozfstwcnihjqxg","umdryebvlapkolistwnnihjqxg","umdryebxlapkozfatwcnihjqxx","uxdryebvlapkozfstwhniheqxg","ufdryebvzapkozfstwcnbhjqxg","amdryhbvlapkozfstwcnifjqxg","umqryebvlaphozfstwcnihjqxn","umdryebvlapkosfstfcnihjqxe","gmkryebvlapkozfstwcnihjmxg","umdrnebvlkpkozfstwcnihjnxg","umdryebvrapkozfstmcndhjqxg","umdryebvmapkozfstichihjqxg","umdryesvnapkozestwcnihjqxg","umeryhbvlapkozfstfcnihjqxg","umdryedvbapkozfstwcnihqqxg","umdryebllapzozfstwcnihjvxg","umdcyebvlzdkozfstwcnihjqxg","umdrybbvlapkbvfstwcnihjqxg","umdrytbglapkozfsthcnihjqxg","umdryebvlkpkozfsteclihjqxg","umdntebvlapkmzfstwcnihjqxg","lkdryebveapkozfstwcnihjqxg","ymdryubvlapkozfstwbnihjqxg","tmrryebvlapkozfstwcnqhjqxg","umdryeovlaekonfstwcnihjqxg","umiryeuvlapkozfstwcnihjwxg","umdryebvlspvozwstwcnihjqxg","umdrtebvlapkoznxtwcnihjqxg","umvryebvlaphozfstwcnahjqxg","umdryebvlapkozfstinniajqxg","umdryebqlapkozfctwcnihjqxx","umdryebvlapkbzfptwcnihjqvg","umdryabviapkozistwcnihjqxd","umdryrbvlapkezfstscnihjqxg","umhryebvlapkozfstacnihxqxg","umdxyelvlapkozfitwcnihjqxg","umdryevvuapkozfstwcnihtqxg","uydrypbvxapkozfstwcnihjqxg","umdryebvlapkopfstwcnihzqxo","uedryebvlapkozistwceihjqxg","umdiyebvlapkozfgtwcnihjqxv","ymdryebvlapkozfsticniqjqxg","umbrkebvlapkozfslwcnihjqxg","umdryebliapkozbstwcnihjqxg","umvryebolapkozfstwcnihjqig","umdryeavbackozfstwcnihjqxg","umdryfbvlapsozfstwcnihaqxg","umdqyebvlapkozfjtgcnihjqxg","umdrjebvlaqkozfstwcyihjqxg","umdryebklaqkozrstwcnihjqxg","umdryebvpapkozfstwcpihjqjg","uydryebhlawkozfstwcnihjqxg","umdyyebvlapkozfstwcykhjqxg","umdryebvlapkozfstwcnitjnxh","umdzyebvlapkozfstwcnehyqxg","mmcryebvlapkozfstwinihjqxg","umdryebvlapuozfstwmvihjqxg","umdryfbvlapkozqstwcnihjmxg","umdryebslapsozfhtwcnihjqxg","umdtyemvlapmozfstwcnihjqxg","umdrxevvlapkozfytwcnihjqxg","umdahebvlapjozfstwcnihjqxg","umdryebvlapkozfstacnivjqxb","umdryebvlzpkozfjtwcnihjyxg","umdryebvlaqkozfstwcnisjqxu","umdrydbvlapkozfsuwcnihjlxg","umdryebvlapkomrstwcnihjqkg","umdryebvlapcozfstmcnwhjqxg","umdryebvlahkozfstwcibhjqxg","gmdrzebvlapkozlstwcnihjqxg","umdryebvlapkezfsswcnrhjqxg","umdryebvlapkoqfitwcgihjqxg","umdrnebvlapkozfsiwcninjqxg","umdryebvlapkozfsrwckohjqxg","umdryebtlapkomfstwcnihjexg","umdryxbvlapjozfstwcnihoqxg","umdpyebvlapkosustwcnihjqxg","umdryebvlapkvzfawwcnihjqxg","umhnyebvlaikozfstwcnihjqxg","umdryebvlagkozfstvknihjqxg","uodryebjlapkoxfstwcnihjqxg","umdryefdlapkozfstwcnyhjqxg","umprmebvtapkozfstwcnihjqxg","umdhyebvlapoozfstwcnihjqgg","uddryebvidpkozfstwcnihjqxg","umdryebtlapkozfetwfnihjqxg","umdbyebolapkozfstwcoihjqxg","umdryebvlapkonfstwcnihjpxo","umdryebvlapkohfstwcnihjqwk","umdryebolalkkzfstwcnihjqxg","updryebvxapkozfstwcnshjqxg","umdryebvlapkovfktwcnuhjqxg","umdrqrbvlppkozfstwcnihjqxg","umdrylgvlapkozfstwrnihjqxg","umdryebvlapkozfstxcnihbqig","uvdryeevlappozfstwcnihjqxg","zmdryebvlapkozfstwcnihqqxt","umdryebvlapvozfstwenihiqxg","umdryebvlbpkozfsgwcnihjlxg","umdryhbvlapkozfstwcnihtqxw","umdreecvlapkozwstwcnihjqxg","umwryebvlapkoztsmwcnihjqxg","ukdryebvfapkozrstwcnihjqxg","umdrylbdlamkozfstwcnihjqxg","umdryebvlapoozwsmwcnihjqxg","umdryebvlapkozfqtwcnnzjqxg","umdryekvlapktzfstwcnohjqxg","umdryebvlapkozfstwcnihjwqo","umdrrebflapkogfstwcnihjqxg","umdryevvlapkozfztwctihjqxg","umdrybbvlapkozfstwcnihxaxg","umdryebvlapkozfsowcnphjqag","smdryebvlapbozfitwcnihjqxg","umdryebvtapiozfstwcnihjqxe","umdryebjlakkozfstwccihjqxg","umdryebvlapdozfshwckihjqxg","umnryebvlapiozfstwcnihlqxg","umdrycbvlapkjzfsnwcnihjqxg","umdryebvyaprozjstwcnihjqxg","ucdryebvlapkozfstwomihjqxg","umdryebvlagklzfstwcnihjqyg","umdryebvladkozfstwcnihjqjh","umdrwebvlapkozfstwdnicjqxg","umdryebvlapkmzfstwcniheqxr","umdryebvlapkjzfstwcviheqxg","umdrvebvlapkozfstwcbihjqmg","umdrfebvlapkoffstwcnihsqxg","umdryebvtarkazfstwcnihjqxg","umdryebvlapkozfstwcfihjcng","umdryebvlapkktostwcnihjqxg","uedryeevlapkozfstwcniijqxg","bmdryebylapkozfstwcnihjqog","umdryebvlmpkoztstwcnihjqeg","umdryepvlarkohfstwcnihjqxg","uwdryebvlapklzfstzcnihjqxg","umdryebklapkozfsswcbihjqxg","umdtyeavlapkozfstwsnihjqxg","umdryebvaapkozfhtfcnihjqxg","umdrpebvlapuozfstwvnihjqxg","umdryebvlapkozffmwcniijqxg","uqdpyebvlapkozfstwfnihjqxg","umdryebvlapuozdstwcnihjhxg","tmdryhbvlapkozfptwcnihjqxg","umdryevvmapkozfstwcnihjgxg","umdryeuvlapmozfstwcnihjwxg","umdryebqlzpkozfbtwcnihjqxg","umdryebvsapkozystwcniqjqxg","imdryebvlapkozfscwinihjqxg","umdryebvlzpkozustwcnmhjqxg","umdrypbvlapbozfsnwcnihjqxg","bmdryebvlapqoznstwcnihjqxg","umdrfebvlapaozfstwcnihxqxg","umdiyebvxapkozfstwcnchjqxg","umdrygbvlapkozfstwcnizjqxz","amdryedvlapkozfstwcnihfqxg","umdryebvvapzozfstwcnihjgxg","undryebvlapkzzfstjcnihjqxg","umdryvbvlapgozfrtwcnihjqxg","umdrkebvlapkozfstwcnihihxg","umdryebvrppkozfsowcnihjqxg","umdryebvlapktzfsdwclihjqxg","otdrdebvlapkozfstwcnihjqxg","mmdryebvlazkozfxtwcnihjqxg","umdryebvlapkozfsbwtnihjqxa","imqryebvrapkozfstwcnihjqxg","umdryebvlrpkozfscwcnihjqlg","uedryebvlapkoznsvwcnihjqxg","umdryebvlqpkozfstscnihjqxj","umerycbvlapkozfstwcnihjqxh","umdkykbvlapjozfstwcnihjqxg"]

sortedcodes = map sort codes

condense :: (Eq a) => [a] -> [Int]
condense (x:xs) = let (y,ys) = gather x xs in (y+1) : condense ys where
  gather :: (Eq a) => a -> [a] -> (Int,[a])
  gather a (b:bs) = if a == b then let (c,cs) = gather a bs in (1+c,cs) else (0,(b:bs))
  gather _ [] = (0,[])
condense [] = []

twos = length (filter (elem 2 . condense) sortedcodes)

threes = length (filter (elem 3 . condense) sortedcodes)

checksum = twos*threes

aresame :: String -> String -> Bool
aresame [] [] = False
aresame (x:xs) (y:ys) = if x == y then aresame xs ys else aresame' xs ys where
  aresame' [] [] = True
  aresame' (x:xs) (y:ys) = if x == y then aresame' xs ys else False

checkpairs (x:xs) = let y = filter (aresame x) xs in if length y > 0 then  map fst (filter (\(a,b) -> a == b) (zip x (head y))) else checkpairs xs
